var AccountWorker=function(){function n(){}return n.User=null,n.CheckUser=function(){!this.IsAuthenticated()||!0},n.IsAuthenticated=function(){var n=this.User!=null;return console.log("AccountWorker.IsAuthenticated()="+n),n},n}(),AjaxLoader;document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){AccountWorker.CheckUser()},1100)});AjaxLoader=function(){function n(){}return n.InitAjaxLoads=function(){for(var i=document.getElementsByClassName("ajax-load-html"),t=0;t<i.length;t++)n.LoadInnerHtmlToElement(i[t],function(){return 2})},n.LoadInnerHtmlToElement=function(n,t){var r=$(n).data("ajax-link"),i=$(n).data("ajax-method"),f=$(n).data("request-data"),u=$(n).data("on-finish-script");i==null&&(i="GET");$.ajax({type:i,url:r,cache:!1,data:f,success:function(i){$(n).html(i);$(n).removeClass("ajax-load-html");u&&eval(u);t&&t()},error:function(n){alert("Произошла ошибка запроса "+r);console.log(n)}})},n}();AjaxLoader.InitAjaxLoads();var CookieWorker=function(){function n(){}return n.setCookie=function(n,t,i){var u="",r;i&&(r=new Date,r.setTime(r.getTime()+i*864e5),u="; expires="+r.toUTCString());document.cookie=n+"="+(t||"")+u+"; path=/"},n.getCookie=function(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)===" ";)t=t.substring(1,t.length);if(t.indexOf(r)===0)return t.substring(r.length,t.length)}return null},n.eraseCookie=function(n){document.cookie=n+"=; Max-Age=-99999999;"},n}(),FormDataHelper=function(){function n(){}return n.CollectDataByPrefix=function(n,t){var r,u,i,f;for(r in n)if(n.hasOwnProperty(r)){if(u=t+r,i=document.getElementsByName(u)[0],i==null){alert("Элемент с именем "+u+" не найден на странице проверьте код");continue}if(i.type==="select-multiple"){n[r]=Array.apply(null,i.options).filter(function(n){return n.selected}).map(function(n){return n.value});continue}if(console.log(u,i,i.type),i.type==="radio"){f=document.querySelector('input[name="'+u+'"]:checked')!=null;f&&(n[r]=document.querySelector('input[name="'+u+'"]:checked')).value;continue}n[r]=i.type==="checkbox"?i.checked:i.value}return n},n.FillData=function(t){n.FillDataByPrefix(t,"")},n.FillDataByPrefix=function(n,t){var r,f,i,e,o,u,s,h;for(r in n)if(f=t+r,i=document.getElementsByName(f)[0],i!==null&&i!==undefined){if(Array.isArray(n[r])){for(i.type!=="select-multiple"&&alert("Попытка присвоить массив элементу ввода который не является select с атрибутом multiple"),e=i,o=function(t){var i=e.options[t],u=n[r].filter(function(n){return i.value===n}).length>0;i.selected=u},u=0;u<e.options.length;u++)o(u);s=new Event("change");i.dispatchEvent(s);continue}i.type==="checkbox"?i.checked=n[r]:i.type==="radio"?document.querySelector("input[name="+f+"][value="+n[r]+"]").checked=!0:i.value=n[r];h=new Event("change");i.dispatchEvent(h)}},n.CollectData=function(t){return n.CollectDataByPrefix(t,"")},n}(),Logger=function(){function n(){}return n.LogException=function(n,t){$.ajax({type:"POST",data:{ExceptionDate:(new Date).toISOString(),Description:"Ошибка запроса к апи",Message:n,Uri:t!==null?t:location.href},url:"/Api/Log/Exception",async:!0,cache:!1,success:function(n){console.log("Исключение залоггировано",n)},error:function(){alert("Произошла ошибка в логгировании ошибки, срочно обратитесь к разработчикам приложения")}})},n.LogAction=function(n,t,i){var r={LogDate:(new Date).toISOString(),GroupName:i,Uri:window.location.href,Description:t,Message:n};console.log("Logger.LogAction",r);$.ajax({type:"POST",data:r,url:"/Api/Log/Action",async:!0,cache:!1,success:function(n){console.log("Действие залоггировано",n)},error:function(){alert("Произошла ошибка в логгировании ошибки, срочно обратитесь к разработчикам приложения")}})},n}(),ModalWorker=function(){function n(){}return n.ShowModal=function(n){n==""||n==null||n==undefined?n="loadingModal":$("#"+n).modal("show")},n.ChangeModalValues=function(n,t,i){t!=null&&(document.getElementById("header"+n).innerText=t);i!=null&&(document.getElementById("body"+n).innerHTML=i)},n.ShowModalWithValues=function(n,t,i){this.ChangeModalValues(n,t,i);this.ShowModal(n)},n.HideModals=function(){$(".modal").modal("hide");$(".modal-backdrop.fade").remove();$(".modal").on("shown.bs.modal",function(){})},n.HideModal=function(n){$("#"+n).modal("hide")},n}(),AjaxParameters=function(){function n(){}return n}(),Requester=function(){function n(){}return n.SendPostRequestWithAnimation=function(t,i,r,u){ModalWorker.ShowModal("loadingModal");n.SendAjaxPost(t,i,r,u,!0)},n.UploadFilesToServer=function(t,i,r){var u="/Api/FilesDirectory/UploadFiles",f,o,e;if(!n.IsRequestGoing(u)){if(f=$("#"+t).prop("files"),o=new FormData,f.length===0){ToastrWorker.HandleBaseApiResponse(new BaseApiResponse(!1,"Файлы не выбраны"));return}for(e=0;e<f.length;e++)o.append("Files",f[e]);$.ajax({url:u,type:"POST",data:o,async:!0,cache:!1,dataType:"json",contentType:!1,processData:!1,success:function(t){console.log(t);n.DeleteCompletedRequest(u);i&&i(t)},error:function(t,i,f){console.log(t,i,f);Logger.LogException(i,u);n.DeleteCompletedRequest(u);ModalWorker.HideModals();var e=new BaseApiResponse(!1,"Произошла ошибка! Мы уже знаем о ней, скоро с ней разберемся!");ToastrWorker.HandleBaseApiResponse(e);r&&r(t,i,f)}})}},n.SendAjaxGet=function(t,i,r,u){if(!n.IsRequestGoing(t)){var f={type:"GET",data:i,url:t,async:!0,cache:!1,success:function(i){n.DeleteCompletedRequest(t);r&&r(i)},error:function(i,r,f){Logger.LogException(r,t);n.DeleteCompletedRequest(t);u&&u(i,r,f)}};$.ajax(f)}},n.SendAjaxPost=function(t,i,r,u,f){var e,o;if(!n.IsRequestGoing(t)){if(i==null){alert("Вы подали пустой объект в запрос");return}e={};e.type="POST";e.data=i;e.url=t;e.async=!0;e.cache=!1;e.success=function(i){n.DeleteCompletedRequest(t);f&&n.OnSuccessAnimationHandler(i);r&&r(i)};e.error=function(i,r,e){Logger.LogException(r,t);n.DeleteCompletedRequest(t);f&&n.OnErrorAnimationHandler();u&&u(i,r,e)};o=i.constructor===Array;o&&(e.contentType="application/json; charset=utf-8",e.dataType="json",e.data=JSON.stringify(i));n.GoingRequests.push(t);$.ajax(e);console.log("POST запрос "+t,i)}},n.GoingRequests=[],n.DeleteCompletedRequest=function(t){n.GoingRequests=n.GoingRequests.filter(function(n){return n!==t})},n.ParseDate=function(n){var t=n.split("."),i=new Date(+t[2],+t[1]-1,+t[0]);return i.toISOString()},n.GetCombinedData=function(t,i){var u={},r,f,e;for(r in i)if(Array.isArray(i[r]))u[t+r]=i[r];else if(typeof i[r]=="object"){f=n.GetCombinedData(""+t+r+".",i[r]);for(e in f)u[e]=f[e]}else u[t+r]=i[r];return u},n.GetParams=function(t){return t=n.GetCombinedData("",t),$.param(t,!0)},n.IsRequestGoing=function(t){var i=n.GoingRequests.filter(function(n){return n===t});return i.length>0},n.OnSuccessAnimationHandler=function(n){ModalWorker.HideModals();ToastrWorker.HandleBaseApiResponse(n)},n.OnErrorAnimationHandler=function(){ModalWorker.HideModals();var n=new BaseApiResponse(!1,"Произошла ошибка! Мы уже знаем о ней, и скоро с ней разберемся!");ToastrWorker.HandleBaseApiResponse(n)},n}(),BaseApiResponse=function(){function n(n,t){this.IsSucceeded=n;this.Message=t}return n}(),ToastrWorker=function(){function n(){}return n.ShowError=function(n){var t={IsSucceeded:!1,Message:n};this.HandleBaseApiResponse(t)},n.ShowSuccess=function(n){var t={IsSucceeded:!0,Message:n};this.HandleBaseApiResponse(t)},n.HandleBaseApiResponse=function(n){if(console.log("HandleBaseApiResponse",n),n.IsSucceeded===undefined){alert("Произошла ошибка. Объект не является типом BaseApiResponse");return}if(n.Message===undefined){alert("Произошла ошибка. Объект не является типом BaseApiResponse");return}toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};n.IsSucceeded?toastr.success(n.Message):toastr.error(n.Message)},n}(),Utils=function(){function n(){}return n.SetDatePicker=function(n,t){t===void 0&&(t=null);$.fn.datepicker.dates.ru={days:["понедельник","воскресенье","вторник","среда","четверг","пятница","суббота"],daysShort:["вс","пн","вт","ср","чт","пт","сб"],daysMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],today:"Today"};$(n).datepicker({format:"dd/mm/yyyy",autoclose:!0,language:"ru",startDate:t})},n.SetDateRangePicker=function(n){$(n).daterangepicker({autoUpdateInput:!1,locale:{cancelLabel:"Очистить",applyLabel:"Применить",daysOfWeek:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],firstDay:0}});$(n).on("apply.daterangepicker",function(n,t){$(this).val(t.startDate.format("DD/MM/YYYY")+" - "+t.endDate.format("DD/MM/YYYY"))});$(n).on("cancel.daterangepicker",function(){$(this).val("")})},n.GetDateFromDateRangePicker=function(n){var f=document.getElementById(n),t,r,u,i;if(f===null)return alert("Элемент с идентификатором "+n+" не найден на странице проверьте код"),null;if(t=f.value.replace(/ /g,""),t=t.split("-"),t!==""){for(r in t)u=t[r].split("/"),u.reverse(),t[r]=u.join("-");return i={},t[0]!==""&&(i={Min:t[0]}),t[1]!=undefined&&(i.Max=t[1]),console.log(i,t[0],t[1]),i}return null},n.GetDateFromDatePicker=function(n){var r=document.getElementById(n),t,i;if(r===[]){alert("Элемент с идентификатором "+n+" не найден на странице проверьте код");return}if(t=r.value.replace(/ /g,""),t!="")return console.log("Not ''"),i=t.split("/"),i.reverse(),i.join("-")},n.FillSelect=function(n,t,i,r){for(var f,u=0;u<t.length;u++)f=document.createElement("option"),f.innerHTML=i(t[u]),f.value=r(t[u]),n.append(f)},n}();